"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(stats)"
"0","library(base)"
"0","##1月"
"0","test.all.jan.t <- full_join(test2015.all.jan, test2016.all.jan, by = c(""Class"", ""Scenic Spots"", ""Location"", ""variable""))"
"0","##將2016沒有或2016才有的景點刪除"
"0","for(i in 1:ncol(test.all.jan.t)) "
"0","{ "
"0","  test.all.jan.t <- test.all.jan.t[!is.na(test.all.jan.t[,i]),] "
"0","}"
"0","test.all.jan.t <- mutate(test.all.jan.t, improve = value.y-value.x)"
"0","#排序"
"0","test.all.jan.t <- head(test.all.jan.t[order(test.all.jan.t$improve, decreasing = T),],10)"
"0","test2015.all.jan.t <- test.all.jan.t %>% group_by(`Scenic Spots`, value.x)%>%mutate(year = ""2015"")"
"0","test2016.all.jan.t <- test.all.jan.t %>% group_by(`Scenic Spots`, value.y)%>%mutate(year = ""2016"")"
"0","test.all.jan <- full_join(test2015.all.jan.t, test2016.all.jan.t)"
"2","Joining, by = c(""Class"", ""Scenic Spots"", ""Location"", ""variable"", ""value.x"", ""value.y"", ""improve"", ""year"")
"
"0","test.all.jan[11:20,5] <- test.all.jan[1:10,6]"
"0","test.all.jan[1:10,2]<-c(""國父紀念館"",""蓮池潭"",""國立臺灣科學教育館"",""國立中正紀念堂"",""鹿港龍山寺"",""士林官邸公園"",""太魯閣國家公園遊客中心"",""小野柳(加路蘭)"",""國立科學工藝博物館"",""淡水漁人碼頭"")"
"0","test.all.jan[11:20,2]<-c(""國父紀念館"",""蓮池潭"",""國立臺灣科學教育館"",""國立中正紀念堂"",""鹿港龍山寺"",""士林官邸公園"",""太魯閣國家公園遊客中心"",""小野柳(加路蘭)"",""國立科學工藝博物館"",""淡水漁人碼頭"")"
"0","#畫圖"
"0","ggplot(test.all.jan, aes(x=reorder(`Scenic Spots`, improve), value.x, fill = year))+"
"0","  geom_bar(stat = ""identity"", position = ""dodge"") +"
"0","  xlab(""觀光景點"") +"
"0","  ylab(""遊客人數"") +"
"0","  ggtitle(""2015~2016年1月份遊客成長數前十名"") +"
"0","  theme_minimal() +"
"0","  coord_flip() +"
"0","  theme(text = element_text(family = ""STHeiti""))"
